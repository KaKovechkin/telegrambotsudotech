import google.generativeai as genai
from config import GEMINI_API_KEY

# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API
genai.configure(api_key=GEMINI_API_KEY)

# 2. –û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏ –±–æ—Ç–∞ (–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)
SYSTEM_PROMPT = """
–¢—ã ‚Äî –ú–æ–π–†–∏—Ç–º, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ —Ç–∞–π–º-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –≤ Telegram.
–¢–≤–æ–∏ –∑–∞–¥–∞—á–∏:
1. –ü–æ–º–æ–≥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏.
2. –î–∞–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–∏–µ —Å–æ–≤–µ—Ç—ã –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
3. –ë—ã—Ç—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º, –Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º.
4. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É, –Ω–∞–ø–æ–º–∏–Ω–∞–π –µ–º—É, —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —á–µ—Ä–µ–∑ –º–µ–Ω—é –∫–Ω–æ–ø–æ–∫.

–ù–µ –ø–∏—à–∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —á–∞—Ç –≤ Telegram.
"""

# 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
model = genai.GenerativeModel(
    "gemini-1.5-flash",
    system_instruction=SYSTEM_PROMPT  # üëà –í–æ—Ç –∑–¥–µ—Å—å –º—ã –ø–µ—Ä–µ–¥–∞–µ–º —Ä–æ–ª—å
)

async def ai_answer(user_text: str) -> str:
    try:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
        response = await model.generate_content_async(user_text)
        return response.text

    except Exception as e:
        return f"‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å –º–æ–∑–≥–æ–º: {e}"